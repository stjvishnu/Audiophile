!-- Embedded JavaScript for Modal -->
<!-- <script>
  document.addEventListener('DOMContentLoaded', function() {
    // Modal controls
    const modal = document.getElementById('productModal');
    const cancelBtn = document.getElementById('cancelBtn');
    const form = document.getElementById('productForm');
    
    // Toggle switch
    const isActiveSwitch = document.getElementById('isActiveSwitch');
    const isActiveInput = document.getElementById('isActive');
    
    // Image upload
    const fileInput = document.getElementById('fileInput');
    const imageSlots = document.getElementById('imageSlots');
    const imageCount = document.getElementById('imageCount');
    let uploadedImages = [];
    
    // Variants
    const variantsContainer = document.getElementById('variantsContainer');
    const addVariantBtn = document.getElementById('addVariantBtn');
    let variantCounter = 0;
    
    // Create initial image slots
    createImageSlots();
    
    // Add initial variant
    addVariant();
    
    // Close modal
    cancelBtn.addEventListener('click', function() {
      modal.classList.add('hidden');
      modal.classList.remove('flex');
    });
    
    // Close modal when clicking outside
    modal.addEventListener('click', function(e) {
      if (e.target === modal) {
        modal.classList.add('hidden');
        modal.classList.remove('flex');
      }
    });
    
    // Toggle switch functionality
    isActiveSwitch.addEventListener('click', function() {
      const currentState = isActiveSwitch.getAttribute('data-state');
      const newState = currentState === 'checked' ? 'unchecked' : 'checked';
      isActiveSwitch.setAttribute('data-state', newState);
      isActiveSwitch.setAttribute('aria-checked', newState === 'checked' ? 'true' : 'false');
      isActiveInput.value = newState === 'checked' ? 'true' : 'false';
    });
    
    // Add variant button
    addVariantBtn.addEventListener('click', function() {
      addVariant();
    });
    
    // Form submission
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Check if at least one product image is uploaded
      if (uploadedImages.length === 0) {
        alert("Please upload at least one product image");
        return;
      }
      
      // Collect form data
      const formData = new FormData(form);
      
      // Add image files
      uploadedImages.forEach((image, index) => {
        formData.append(`productImage${index}`, image);
      });
      
      // Convert FormData to object for processing
      const formObject = Object.fromEntries(formData);
      console.log("Form submitted!", formObject);
      
      // Show success message
      showToast("Product created successfully!");
      
      // Reset form and close modal
      form.reset();
      resetImageSlots();
      modal.classList.add('hidden');
      modal.classList.remove('flex');
    });
    
    // Image slots creation
    function createImageSlots() {
      imageSlots.innerHTML = '';
      
      for (let i = 0; i < 5; i++) {
        const slot = document.createElement('div');
        const hasImage = i < uploadedImages.length;
        
        slot.className = `relative rounded-lg overflow-hidden h-32 border-2 transition-all duration-300 animate-scale-in ${hasImage ? 'border-gray-300' : 'border-dashed border-gray-400 hover:border-gray-600 cursor-pointer'}`;
        slot.style.animationDelay = `${i * 100}ms`;
        
        if (hasImage) {
          // Create image preview
          slot.innerHTML = `
            <img src="${URL.createObjectURL(uploadedImages[i])}" alt="Product ${i + 1}" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
            <button type="button" class="absolute top-1 right-1 bg-white/80 backdrop-blur-sm rounded-full p-1.5 shadow-md hover:bg-red-50 transition-all duration-200 remove-image" data-index="${i}">
              <i class="ri-close-line text-red-500"></i>
            </button>
          `;
        } else {
          // Create empty slot
          slot.innerHTML = `
            <div class="flex flex-col items-center justify-center h-full p-3 group">
              <i class="ri-image-line text-3xl text-gray-400 group-hover:text-gray-600 transition-colors duration-300 animate-float"></i>
              <p class="mt-2 text-xs font-medium text-gray-500 text-center group-hover:text-gray-700 transition-colors duration-300">
                ${i === 0 && uploadedImages.length === 0 ? "Add Primary Image*" : "Add Image"}
              </p>
            </div>
          `;
          
          slot.addEventListener('click', function() {
            if (uploadedImages.length < 5) {
              fileInput.click();
            }
          });
        }
        
        imageSlots.appendChild(slot);
      }
      
      // Add event listeners to remove buttons
      const removeButtons = document.querySelectorAll('.remove-image');
      removeButtons.forEach(button => {
        button.addEventListener('click', function(e) {
          e.stopPropagation();
          const index = parseInt(this.getAttribute('data-index'));
          removeImage(index);
        });
      });
      
      // Update image count
      imageCount.textContent = `${uploadedImages.length}/5 images`;
    }
    
    // File input change
    fileInput.addEventListener('change', function() {
      if (this.files && this.files.length > 0) {
        const newFiles = Array.from(this.files);
        
        // Check if adding new files would exceed the limit
        if (uploadedImages.length + newFiles.length > 5) {
          alert("Maximum 5 images allowed");
          return;
        }
        
        // Add new files to the uploadedImages array
        uploadedImages = [...uploadedImages, ...newFiles];
        
        // Update image slots
        createImageSlots();
        
        // Reset file input
        this.value = '';
      }
    });
    
    // Remove image
    function removeImage(index) {
      uploadedImages.splice(index, 1);
      createImageSlots();
    }
    
    // Reset image slots
    function resetImageSlots() {
      uploadedImages = [];
      createImageSlots();
    }
    
    // Add variant
    function addVariant() {
      const variantId = `variant-${variantCounter}`;
      variantCounter++;
      
      const variantElement = document.createElement('div');
      variantElement.className = 'border rounded-lg p-5 space-y-4 bg-white shadow-sm hover:shadow-md transition-all duration-300 animate-fade-in';
      variantElement.id = variantId;
      
      variantElement.innerHTML = `
        <div class="flex justify-between items-center">
          <h4 class="font-medium text-gray-700">Variant #${variantCounter}</h4>
          ${variantCounter > 1 ? `
            <button type="button" class="remove-variant text-red-500 hover:text-red-700 hover:bg-red-50 transition-colors duration-300 p-1.5 rounded-md">
              <i class="ri-delete-bin-line mr-1"></i>
              Remove
            </button>
          ` : ''}
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="space-y-2">
            <label for="${variantId}-color" class="block font-medium text-gray-700">Color *</label>
            <input id="${variantId}-color" name="variants[${variantCounter-1}][color]" placeholder="e.g. Black, Red, Blue" required 
              class="w-full h-10 px-3 py-2 rounded-md border border-gray-300 bg-white text-base transition-all duration-300 focus:ring-2 focus:ring-gray-400 focus:outline-none shadow-sm">
          </div>
          
          <div class="space-y-2">
            <label for="${variantId}-connectorType" class="block font-medium text-gray-700">Connector Type *</label>
            <select id="${variantId}-connectorType" name="variants[${variantCounter-1}][connectorType]" required
              class="w-full h-10 px-3 py-2 rounded-md border border-gray-300 bg-white text-base transition-all duration-300 focus:ring-2 focus:ring-gray-400 focus:outline-none shadow-sm">
              <option value="" disabled selected>Select connector type</option>
              <option value="Type-C">Type-C</option>
              <option value="3.5mm">3.5mm</option>
              <option value="Wireless">Wireless</option>
            </select>
          </div>
          
          <div class="space-y-2">
            <label for="${variantId}-stock" class="block font-medium text-gray-700">Stock *</label>
            <input id="${variantId}-stock" name="variants[${variantCounter-1}][stock]" type="number" placeholder="0" required min="0"
              class="w-full h-10 px-3 py-2 rounded-md border border-gray-300 bg-white text-base transition-all duration-300 focus:ring-2 focus:ring-gray-400 focus:outline-none shadow-sm">
          </div>
          
          <div class="space-y-2">
            <label for="${variantId}-price" class="block font-medium text-gray-700">Price * ($)</label>
            <input id="${variantId}-price" name="variants[${variantCounter-1}][price]" type="number" placeholder="0.00" required min="0" step="0.01"
              class="w-full h-10 px-3 py-2 rounded-md border border-gray-300 bg-white text-base transition-all duration-300 focus:ring-2 focus:ring-gray-400 focus:outline-none shadow-sm">
          </div>
          
          <div class="space-y-2">
            <label for="${variantId}-sku" class="block font-medium text-gray-700">SKU *</label>
            <input id="${variantId}-sku" name="variants[${variantCounter-1}][sku]" placeholder="Stock Keeping Unit" required
              class="w-full h-10 px-3 py-2 rounded-md border border-gray-300 bg-white text-base transition-all duration-300 focus:ring-2 focus:ring-gray-400 focus:outline-none shadow-sm">
          </div>
          
          <div class="col-span-1 md:col-span-2 flex items-center space-x-3">
            <div class="switch-root" id="${variantId}-isActiveSwitch" data-state="checked" role="switch" aria-checked="true" tabindex="0">
              <div class="switch-thumb"></div>
            </div>
            <label for="${variantId}-isActiveSwitch" class="font-medium text-gray-700">Variant Active Status</label>
            <input type="hidden" name="variants[${variantCounter-1}][isActive]" id="${variantId}-isActive" value="true">
          </div>
          
          <!-- Variant images with 5-slot design -->
          <div class="col-span-1 md:col-span-2 space-y-2">
            <div class="flex justify-between items-center">
              <label class="block font-medium text-gray-700">Variant Images (Max 5)</label>
              <span class="text-sm text-gray-500" id="${variantId}-imageCount">0/5 images</span>
            </div>
            
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3" id="${variantId}-imageSlots">
              <!-- Variant image slots will be added by JavaScript -->
            </div>
            
            <input id="${variantId}-fileInput" type="file" accept="image/*" multiple class="hidden">
          </div>
        </div>
      `;
      
      variantsContainer.appendChild(variantElement);
      
      // Setup variant image slots
      setupVariantImageSlots(variantId);
      
      // Setup variant switch
      const variantSwitch = document.getElementById(`${variantId}-isActiveSwitch`);
      const variantIsActiveInput = document.getElementById(`${variantId}-isActive`);
      
      variantSwitch.addEventListener('click', function() {
        const currentState = variantSwitch.getAttribute('data-state');
        const newState = currentState === 'checked' ? 'unchecked' : 'checked';
        variantSwitch.setAttribute('data-state', newState);
        variantSwitch.setAttribute('aria-checked', newState === 'checked' ? 'true' : 'false');
        variantIsActiveInput.value = newState === 'checked' ? 'true' : 'false';
      });
      
      // Setup remove variant button
      const removeButton = variantElement.querySelector('.remove-variant');
      if (removeButton) {
        removeButton.addEventListener('click', function() {
          variantElement.remove();
        });
      }
    }
    
    // Setup variant image slots
    function setupVariantImageSlots(variantId) {
      const variantImageSlots = document.getElementById(`${variantId}-imageSlots`);
      const variantFileInput = document.getElementById(`${variantId}-fileInput`);
      const variantImageCount = document.getElementById(`${variantId}-imageCount`);
      let variantUploadedImages = [];
      
      // Create initial slots
      for (let i = 0; i < 5; i++) {
        const slot = document.createElement('div');
        slot.className = 'relative rounded-lg overflow-hidden h-24 border-2 border-dashed border-gray-400 hover:border-gray-600 cursor-pointer transition-all duration-300 animate-scale-in';
        slot.style.animationDelay = `${i * 100}ms`;
        
        slot.innerHTML = `
          <div class="flex flex-col items-center justify-center h-full p-2 group">
            <i class="ri-image-line text-2xl text-gray-400 group-hover:text-gray-600 transition-colors duration-300"></i>
            <p class="mt-1 text-xs font-medium text-gray-500 text-center group-hover:text-gray-700 transition-colors duration-300">
              Add Image
            </p>
          </div>
        `;
        
        slot.addEventListener('click', function() {
          if (variantUploadedImages.length < 5) {
            variantFileInput.click();
          }
        });
        
        variantImageSlots.appendChild(slot);
      }
      
      // File input change for variant
      variantFileInput.addEventListener('change', function() {
        if (this.files && this.files.length > 0) {
          const newFiles = Array.from(this.files);
          
          // Check if adding new files would exceed the limit
          if (variantUploadedImages.length + newFiles.length > 5) {
            alert("Maximum 5 images allowed per variant");
            return;
          }
          
          // Add new files to the variantUploadedImages array
          variantUploadedImages = [...variantUploadedImages, ...newFiles];
          
          // Update variant image slots
          updateVariantImageSlots();
          
          // Reset file input
          this.value = '';
        }
      });
      
      // Update variant image slots
      function updateVariantImageSlots() {
        variantImageSlots.innerHTML = '';
        
        for (let i = 0; i < 5; i++) {
          const slot = document.createElement('div');
          const hasImage = i < variantUploadedImages.length;
          
          slot.className = `relative rounded-lg overflow-hidden h-24 border-2 transition-all duration-300 animate-scale-in ${hasImage ? 'border-gray-300' : 'border-dashed border-gray-400 hover:border-gray-600 cursor-pointer'}`;
          slot.style.animationDelay = `${i * 100}ms`;
          
          if (hasImage) {
            // Create image preview
            slot.innerHTML = `
              <img src="${URL.createObjectURL(variantUploadedImages[i])}" alt="Variant Image ${i + 1}" class="w-full h-full object-cover transition-transform duration-300">
              <button type="button" class="absolute top-1 right-1 bg-white/80 backdrop-blur-sm rounded-full p-1 shadow-md hover:bg-red-50 transition-all duration-200 variant-remove-image" data-index="${i}">
                <i class="ri-close-line text-red-500 text-xs"></i>
              </button>
            `;
          } else {
            // Create empty slot
            slot.innerHTML = `
              <div class="flex flex-col items-center justify-center h-full p-2 group">
                <i class="ri-image-line text-2xl text-gray-400 group-hover:text-gray-600 transition-colors duration-300"></i>
                <p class="mt-1 text-xs font-medium text-gray-500 text-center group-hover:text-gray-700 transition-colors duration-300">
                  Add Image
                </p>
              </div>
            `;
            
            slot.addEventListener('click', function() {
              if (variantUploadedImages.length < 5) {
                variantFileInput.click();
              }
            });
          }
          
          variantImageSlots.appendChild(slot);
        }
        
        // Add event listeners to remove buttons
        const removeButtons = variantImageSlots.querySelectorAll('.variant-remove-image');
        removeButtons.forEach(button => {
          button.addEventListener('click', function(e) {
            e.stopPropagation();
            const index = parseInt(this.getAttribute('data-index'));
            removeVariantImage(index);
          });
        });
        
        // Update image count
        variantImageCount.textContent = `${variantUploadedImages.length}/5 images`;
      }
      
      // Remove variant image
      function removeVariantImage(index) {
        variantUploadedImages.splice(index, 1);
        updateVariantImageSlots();
      }
    }
    
    // Toast notification
    function showToast(message) {
      const toast = document.createElement('div');
      toast.className = 'fixed bottom-4 right-4 bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg animate-fade-in flex items-center';
      toast.innerHTML = `
        <i class="ri-check-line mr-2 text-green-400"></i>
        <span>${message}</span>
      `;
      
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.classList.replace('animate-fade-in', 'animate-fade-out');
        setTimeout(() => {
          toast.remove();
        }, 300);
      }, 3000);
    }
  });
</script> -->