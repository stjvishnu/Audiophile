<div class="min-h-screen bg-black text-white p-2 sm:p-4 md:p-6 lg:p-8">
  <div class="max-w-7xl mx-auto space-y-3 sm:space-y-4">

    <!-- Header -->
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 rounded-xl sm:rounded-[1.5rem] p-3 sm:p-4 border border-white border-opacity-40">
      <h2 class="text-xl sm:text-2xl md:text-3xl font-bold">Sales Report</h2>
      <div class="flex flex-col sm:flex-row w-full sm:w-auto gap-2">
        <button onclick="downloadReport('pdf')" class="group border bg-white text-black border-black px-3 sm:px-4 py-2 rounded-lg hover:bg-black hover:text-white hover:border hover:border-white transition text-sm sm:text-base w-full sm:w-auto">
          <i class="fa-solid fa-file-pdf text-black group-hover:text-white"></i> Download PDF
        </button>
        <button onclick="downloadReport('excel')" class="group border bg-white text-black border-black px-3 sm:px-4 py-2 rounded-lg hover:bg-black hover:text-white hover:border hover:border-white transition text-sm sm:text-base w-full sm:w-auto">
          <i class="fa-solid fa-file-csv"></i> Download Excel
        </button>
      </div>
    </div>

    <!-- Filters -->
    <div class="bg-black text-white p-3 sm:p-4 md:p-5 rounded-xl sm:rounded-[1.5rem] border border-white border-opacity-40">
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4">

        <div>
          <label class="block mb-1.5 sm:mb-2 text-sm sm:text-base">Range</label>
          <select id="selection" class="w-full bg-white text-black border rounded-lg px-2 sm:px-3 py-2 outline-none text-sm sm:text-base">
            <option value="">Select</option>
            <option>Daily</option>
            <option>Weekly</option>
            <option>Monthly</option>
            <option>Yearly</option>
            <option>Custom</option>
          </select>
        </div>

        <div>
          <label class="block mb-1.5 sm:mb-2 text-sm sm:text-base">Start Date</label>
          <input id="startDate" value="" type="text" placeholder="DD/MM/YYYY" class="w-full bg-white text-black border rounded-lg px-2 sm:px-3 py-2 outline-none text-sm sm:text-base">
        </div>

        <div>
          <label class="block mb-1.5 sm:mb-2 text-sm sm:text-base">End Date</label>
          <input id="endDate" value="" type="text" placeholder="DD/MM/YYYY" class="w-full bg-white text-black border rounded-lg px-2 sm:px-3 py-2 outline-none text-sm sm:text-base">
        </div>

        <div class="flex gap-2 sm:col-span-2 md:col-span-1 md:items-end">
          <button id="applyBtn" class="flex-1 bg-white text-black px-3 sm:px-4 py-2 rounded-lg hover:bg-black hover:text-white hover:border hover:border-white transition text-sm sm:text-base">
            Apply
          </button>
          <button class="flex-1 bg-gray-200 text-black px-3 sm:px-4 py-2 rounded-lg hover:bg-gray-800 hover:text-white hover:border hover:border-white transition text-sm sm:text-base">
            <a href="/admin/sales-report">Clear</a>
          </button>
        </div>

      </div>
    </div>

    <!-- Metrics -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
      <div class="bg-white text-black p-3 sm:p-4 rounded-xl sm:rounded-2xl flex flex-col sm:flex-row justify-between items-start sm:items-center gap-1 sm:gap-0">
        <span class="text-sm sm:text-base">Overall Sales Count</span>
        <span id="salesCount" class="font-bold text-lg sm:text-xl"><%=locals.salesCount%></span>
      </div>

      <div class="bg-white text-black p-3 sm:p-4 rounded-xl sm:rounded-2xl flex flex-col sm:flex-row justify-between items-start sm:items-center gap-1 sm:gap-0">
        <span class="text-sm sm:text-base">Overall Order Amount</span>
        <span id="orderAmount" class="font-bold text-lg sm:text-xl">₹<%=locals.orderAmount%></span>
      </div>

      <div class="bg-white text-black p-3 sm:p-4 rounded-xl sm:rounded-2xl flex flex-col sm:flex-row justify-between items-start sm:items-center gap-1 sm:gap-0 sm:col-span-2 lg:col-span-1">
        <span class="text-sm sm:text-base">Overall Discount</span>
        <span id="discountAmount" class="font-bold text-lg sm:text-xl">₹<%=locals.discountAmount%></span>
      </div>
    </div>

    <!-- ================== DESKTOP TABLE (lg and above) ================== -->
    <div class="hidden lg:block">
      <div class="bg-black rounded-xl lg:rounded-[2rem] border border-gray-800 overflow-x-auto text-white w-full">
        <table class="w-full border-collapse min-w-[900px]">
          <thead>
            <tr class="border-b border-gray-800 text-sm lg:text-base">
              <th class="p-2 lg:p-3 text-left">NO</th>
              <th class="p-2 lg:p-3 text-left">Order ID</th>
              <th class="p-2 lg:p-3 text-left">User Name</th>
              <th class="p-2 lg:p-3 text-left">Payment</th>
              <th class="p-2 lg:p-3 text-left">Status</th>
              <th class="p-2 lg:p-3 text-left">Products</th>
              <th class="p-2 lg:p-3 text-left">SubTotal</th>
              <th class="p-2 lg:p-3 text-left">Discount</th>
              <th class="p-2 lg:p-3 text-left">Shipping</th>
              <th class="p-2 lg:p-3 text-left">Grand Total</th>
            </tr>
          </thead>

          <tbody id="orderContainerDesktop"  class="text-sm lg:text-base">
            <% if(orders && orders.length>0) { %>
              <% orders.forEach((order,index)=>{ %>
                <tr  class="border-b border-gray-800 hover:bg-[#222] transition"
                    style="animation: slideIn 0.6s ease forwards; animation-delay:<%= index * 0.1 %>s; opacity:0;">

                  <td class="p-2 lg:p-3"><%= index+1 %></td>
                  <td class="p-2 lg:p-3 font-semibold"><%= order?.orderNumber %></td>
                  <td class="p-2 lg:p-3"><%= order?.user?.firstName %></td>
                  <td class="p-2 lg:p-3 text-gray-300"><%= order?.payment.method %></td>
                  <td class="p-2 lg:p-3"><%= order?.orderStatus %></td>

                  <td class="p-2 lg:p-3">
                    <div class="flex flex-col gap-1.5">
                      <% order.items.forEach(item => { %>
                        <span class="inline-flex items-center gap-2 px-2 py-0.5 rounded-2xl text-xs bg-gray-100/30 text-black border border-gray-700">
                          <span class="font-medium"><%= item.productName %></span>
                          <span class="px-1.5 py-0.5 bg-black text-white text-[10px] rounded-2xl">
                            <%= item.productColor || '—' %>
                          </span>
                          <% if (item.quantity) { %>
                            <span class="px-1.5 py-0.5 bg-black rounded-2xl text-[10px] text-white">
                              <%= item.quantity %>
                            </span>
                          <% } %>
                          <span class="text-gray-500">× <%= item.quantity %></span>
                        </span>
                      <% }) %>
                    </div>
                  </td>

                  <td class="p-2 lg:p-3">
                    <span class="bg-gray-100 text-black px-2 lg:px-3 py-1 rounded-full text-xs">
                      ₹<%= order?.subTotal %>
                    </span>
                  </td>

                  <td class="p-2 lg:p-3">
                    <span class="bg-gray-100 text-black px-2 lg:px-3 py-1 rounded-full text-xs">
                      ₹<%=order?.discount %>
                    </span>
                  </td>

                  <td class="p-2 lg:p-3">
                    <span class="bg-gray-100 text-black px-2 lg:px-3 py-1 rounded-full text-xs">
                      ₹<%=order?.deliveryCharge %>
                    </span>
                  </td>

                  <td class="p-2 lg:p-3">
                    <span class="bg-gray-100 text-black px-2 lg:px-3 py-1 rounded-full text-xs font-semibold">
                      ₹<%=order?.total %>
                    </span>
                  </td>
                </tr>
              <% }) %>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ================== TABLET VIEW (md) ================== -->
    <div class="hidden md:block lg:hidden">
      <div id="orderContainerTablet" class="space-y-3">
        <% if(orders && orders.length>0) { %>
          <% orders.forEach((order,index)=>{ %>
            <div  class="bg-black border border-white/30 rounded-xl p-4 space-y-3 transform transition-all duration-500 hover:scale-[1.01]"
                 style="animation: slideIn 0.5s ease-out forwards; animation-delay:<%=index*0.1%>s; opacity:0; transform:translateY(20px);">
              
              <div class="flex justify-between items-start">
                <div>
                  <div class="text-sm text-gray-400">#<%= index+1 %></div>
                  <div class="text-lg font-semibold text-white mt-1">
                    <%= order?.orderNumber %>
                  </div>
                </div>
                <div class="text-right">
                  <div class="text-sm text-gray-400">User</div>
                  <div class="text-white font-medium"><%= order?.user.firstName %></div>
                </div>
              </div>

              <div class="grid grid-cols-2 gap-3 text-sm">
                <div>
                  <span class="text-gray-400">Payment:</span>
                  <span class="ml-1 px-2 py-0.5 bg-gray-100 text-black rounded-lg text-xs">
                    <%= order?.payment.method %>
                  </span>
                </div>
                <div>
                  <span class="text-gray-400">Status:</span>
                  <span class="ml-1 px-2 py-0.5 bg-gray-100 text-black rounded-lg text-xs">
                    <%= order?.orderStatus %>
                  </span>
                </div>
              </div>

              <div class="space-y-1.5">
                <div class="text-sm text-gray-400">Products:</div>
                <div class="flex flex-wrap gap-1.5">
                  <% order.items.forEach(item => { %>
                    <span class="inline-flex items-center gap-1.5 px-2 py-1 rounded-lg text-xs bg-gray-100/30 text-black border border-gray-700">
                      <span class="font-medium"><%= item.productName %></span>
                      <span class="px-1.5 py-0.5 bg-black text-white text-[10px] rounded">
                        <%= item.productColor || '—' %>
                      </span>
                      <span class="text-gray-500">× <%= item.quantity %></span>
                    </span>
                  <% }) %>
                </div>
              </div>

              <div class="grid grid-cols-2 sm:grid-cols-4 gap-2 pt-2 border-t border-gray-700 text-sm">
                <div>
                  <div class="text-gray-400 text-xs">SubTotal</div>
                  <div class="text-white font-semibold">₹<%= order?.subTotal %></div>
                </div>
                <div>
                  <div class="text-gray-400 text-xs">Discount</div>
                  <div class="text-white font-semibold">₹<%=order?.discount %></div>
                </div>
                <div>
                  <div class="text-gray-400 text-xs">Shipping</div>
                  <div class="text-white font-semibold">₹<%=order?.deliveryCharge %></div>
                </div>
                <div>
                  <div class="text-gray-400 text-xs">Total</div>
                  <div class="text-white font-bold text-base">₹<%=order?.total %></div>
                </div>
              </div>
            </div>
          <% }) %>
        <% } %>
      </div>
    </div>

    <!-- ================== MOBILE CARDS (below md) ================== -->
    <div id="orderContainerMobile" class="md:hidden space-y-3 sm:space-y-4">
      <% if(orders && orders.length>0) { %>
        <% orders.forEach((order,index)=>{ %>
          <div  class="bg-black border border-white/30 rounded-xl p-3 sm:p-4 space-y-3 transform transition-all duration-500 hover:scale-[1.01]"
               style="animation: slideIn 0.5s ease-out forwards; animation-delay:<%=index*0.1%>s; opacity:0; transform:translateY(20px);">

            <div class="flex justify-between items-center text-gray-300 text-xs sm:text-sm">
              <span>#<%= index+1 %></span>
              <span><%= new Date(order.createdAt).toLocaleDateString('en-IN')%></span>
            </div>

            <div class="text-base sm:text-lg font-semibold text-white">
              Order: <%= order?.orderNumber %>
            </div>

            <div class="text-sm sm:text-base text-gray-400">
              User: <span class="text-white"><%= order?.user.firstName %></span>
            </div>

            <div class="flex flex-wrap gap-2">
              <span class="px-2 sm:px-3 py-1 bg-gray-100 text-black rounded-lg text-xs sm:text-sm">
                <%= order?.payment.method %>
              </span>
              <span class="px-2 sm:px-3 py-1 bg-gray-100 text-black rounded-lg text-xs sm:text-sm">
                <%= order?.orderStatus %>
              </span>
            </div>

            <div class="grid grid-cols-2 gap-2 text-xs sm:text-sm">
              <div>
                <span class="text-gray-400">SubTotal:</span>
                <span class="text-white font-semibold ml-1">₹<%= order?.subTotal %></span>
              </div>
              <div>
                <span class="text-gray-400">Discount:</span>
                <span class="text-white font-semibold ml-1">₹<%=order?.discount %></span>
              </div>
              <div>
                <span class="text-gray-400">Shipping:</span>
                <span class="text-white font-semibold ml-1">₹<%=order?.deliveryCharge %></span>
              </div>
              <div>
                <span class="text-gray-400">Total:</span>
                <span class="text-white font-bold ml-1 text-sm sm:text-base">₹<%=order?.total %></span>
              </div>
            </div>

            <button onclick="orderDetails('<%= order?._id %>')"
              class="w-full bg-white text-black py-2 rounded-lg font-semibold mt-2 text-sm sm:text-base hover:bg-gray-200 transition">
              View Details
            </button>
          </div>
        <% }) %>
      <% } %>
    </div>

    <%-include('./partials/pagination.ejs') %>

  </div>
</div>

<style>
  @keyframes slideIn {
    from { 
      opacity: 0; 
      transform: translateY(15px); 
    }
    to { 
      opacity: 1; 
      transform: translateY(0); 
    }
  }

  /* Remove scrollbar globally */
  body {
    overflow-x: hidden;
    margin: 0;
    padding: 0;
  }

  /* Hide scrollbar for tables while keeping functionality */
  .overflow-x-auto {
    scrollbar-width: thin;
    scrollbar-color: #374151 transparent;
  }

  .overflow-x-auto::-webkit-scrollbar {
    height: 6px;
  }

  .overflow-x-auto::-webkit-scrollbar-track {
    background: transparent;
  }

  .overflow-x-auto::-webkit-scrollbar-thumb {
    background-color: #374151;
    border-radius: 3px;
  }
</style>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="/js/admin/sales-report-script.js"></script>