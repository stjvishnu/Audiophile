
<div class="py-3 px-4">
    <!-- Main Product Container - Large like Hero Carousel -->
    <div class="carousel-container bg-white  mx-4 sm:mx-4 my-5 mt-3 rounded-[2rem] sm:rounded-[5.5rem] relative  ">
        <div>
            <!-- Product Overview Section -->
            <div class=" grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-10 p-14 sm:p-10 lg:pb-12 lg:pl-12 lg:pr-12 ">
                
                <!-- Left Column - Product Images -->
                <div class="flex justify-center items-start rounded-[1.5rem]  sm:rounded-[5rem] bg-white shadow-gray-200 shadow-[0_0_20px_rgba(0,0,0,0.25)]">
                    <div class="  max-w-lg relative ">
                        <!-- Main Product Image -->
                        <div class="mb-3 rounded-[1.5rem] sm:rounded-[5rem] overflow-visible p-4">
                            <img id="main-image" 
                                 src="<%= product.variants[0].attributes.productImages[0] %>" 
                                 data-zoom-image="<%= product.variants[0].attributes.productImages[0] %>" 
                                 alt="<%= product.name %>" 
                                 class="w-full h-auto object-contain pt-2 pl-4 pr-4 transition-all duration-500 rounded-[1.5rem] sm:rounded-[5rem]">
                        </div>
                        
                        <!-- Thumbnail Images -->
                        <div class="grid grid-cols-5 gap-2 mb-3">
                            <% for (let i = 0; i < 5 && i < product.variants[0].attributes.productImages.length; i++) { %>
                                <div class="thumbnail <%= i === 0 ? 'active' : '' %> cursor-pointer rounded-[2rem] sm:rounded-[2rem] overflow-hidden border-2 border-transparent transition-all duration-300" 
                                     onclick="changeImage('<%= product.variants[0].attributes.productImages[i] %>', this)">
                                    <img src="<%= product.variants[0].attributes.productImages[i] %>" 
                                         alt="Thumbnail <%= i + 1 %>" 
                                         class="w-full h-auto object-cover aspect-square">
                                </div>
                            <% } %>
                        </div>
                    </div>
                </div>

                <!-- Right Column - Product Details -->
                <div class="flex flex-col justify-center space-y-3 space-x-9 rounded-[1.5rem] sm:rounded-[5rem] bg-white shadow-gray-200 shadow-[0_0_20px_rgba(0,0,0,0.25)]">
                    <div class="pl-14">
                        <p class="text-gray-700 tracking-widest pt-7 pb-4 font-sans text-lg"><%= product.brand %></p>
                        <h1 class="text-3xl sm:text-4xl lg:text-5xl font-extrabold text-gray-800 mt-2 leading-tight tracking-wide">
                            <%= product.name %>
                        </h1>
                        <p class="text-gray-600 text-lg mt-3"><%= product.productDetails.driverConfiguration %></p>
                    </div>

                    <div class="rounded-2xl pl-6">
                        <div class="flex items-center mb-2">
                            <span class="text-4xl font-bold font-sans text-gray-900">
                                <%= Math.round(product.variants[0].attributes.price * 0.01 * (100 - product.variants[0].attributes.discount)) %> â‚¹
                            </span>
                            <span class="ml-3 text-xl text-gray-500 line-through"><%= product.variants[0].attributes.price %></span>
                            <span class="ml-3 bg-gray-500 text-white px-3 py-1 rounded-full text-sm font-semibold"><%= product.variants[0].attributes.discount %> % off</span>
                        </div>
                    </div>

                    <div class="space-y-6 pl-7">
                        <div>
                            <p class="text-gray-700 font-semibold mb-3 text-lg">
                                Color: <span id="selected-color" class="text-gray-900"><%= product.variants[0].attributes.color%></span>
                            </p>
                            <div class="flex space-x-3">
                                <div class="variant-option active cursor-pointer group" data-value="Black" onclick="selectVariant(this, 'color')">
                                    <div class="w-10 h-10 bg-<%= product.variants[0].attributes.color%>-300  rounded-full border-4 border-black/30  group-hover:border-black transition-all duration-300 shadow-md"></div>
                                    <p class="text-sm mt-2 text-center font-medium"><%= product.variants[0].attributes.color%>/p>
                                </div>
                                <div class="variant-option cursor-pointer group" data-value="Graphite" onclick="selectVariant(this, 'color')">
                                    <div class="w-10 h-10 bg-gray-600 rounded-full border-4 border-transparent group-hover:border-black transition-all duration-300 shadow-md"></div>
                                    <p class="text-sm mt-2 text-center font-medium">Graphite</p>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <p class="text-gray-700 font-semibold mb-2 text-lg">
                                Type: <span id="selected-type" class="text-gray-900">With Mic</span>
                            </p>
                            <div class="flex space-x-4">
                                <div class="variant-option active cursor-pointer group" data-value="With Mic" onclick="selectVariant(this, 'type')">
                                    <div class="w-14 h-10 flex items-center justify-center bg-blue-50 rounded-xl border-2 border-blue-200 group-hover:border-blue-400 transition-all duration-300 shadow-sm">
                                        <i class="fas fa-microphone text-blue-600"></i>
                                    </div>
                                    <p class="text-sm mt-2 text-center font-medium">With Mic</p>
                                </div>
                                <div class="variant-option cursor-pointer group" data-value="Without Mic" onclick="selectVariant(this, 'type')">
                                    <div class="w-14 h-10 flex items-center justify-center bg-gray-50 rounded-xl border-2 border-gray-200 group-hover:border-gray-400 transition-all duration-300 shadow-sm">
                                        <i class="fas fa-ban text-gray-600"></i>
                                    </div>
                                    <p class="text-sm mt-2 text-center font-medium">Without Mic</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center  rounded-xl pl-5">
                        <span class=" text-green-800 text-sm font-semibold px-3 py-1 rounded-full">In Stock</span>
                        <span class="ml-3 text-gray-700 font-medium"><%= product.variants[0].attributes.stock %> units available</span>
                    </div>

                    <div class="flex items-center justify-center flex-col sm:flex-row gap-4 pt-2 pb-8">
                        <button id="addToCartBtn" data-product-id= "<%=product.id %>" class="bg-black hover:bg-blue-700 text-white font-semibold py-4 px-8 rounded-xl flex items-center justify-center transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                            <i class="fas fa-shopping-cart mr-3"></i> 
                            Add to Cart
                        </button>
                        <button class="border-2 border-gray-300 hover:border-gray-400 hover:bg-gray-50 text-gray-700 font-semibold py-4 px-8 rounded-xl flex items-center justify-center transition-all duration-300">
                            <i class="fas fa-heart mr-3"></i> 
                            Wishlist
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</div>

<%-//include ('cart')%> //we can remove this

<style>
.thumbnail.active {
    border-color: #3B82F6 !important;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
}
.variant-option.active .w-12,
.variant-option.active .w-16 {
    border-color: #3B82F6 !important;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
}
.tab-button.active {
    color: #3B82F6;
    border-bottom-color: #3B82F6 !important;
    background-color: white;
}
.carousel-container {
    overflow: visible !important;
    position: relative;
}
.mb-3.rounded-[1.5rem].sm\:rounded-[5rem] {
    overflow: visible !important;
    position: relative;
}

* {
    transition: all 0.3s ease;
}
</style>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/elevatezoom/3.0.8/jquery.elevatezoom.min.js"></script>

<script>
$(document).ready(function() {
    console.log("jQuery loaded!");
    if ($.fn.elevateZoom) {
        console.log("ElevateZoom loaded!");
        $("#main-image").elevateZoom({
            zoomType: "lens",
            lensShape: "square",
            lensSize: 200,
            zIndex: 10000,
            borderSize: 2,
            borderColour: "#3B82F6",
            scrollZoom: false,
            responsive: true,
            containLensZoom: true,
            zoomWindowPosition: 1
        });
    } else {
        console.error("ElevateZoom not loaded!");
    }

    jQuery.event.special.touchmove = {
        setup: function(_, ns, handle) {
            this.addEventListener('touchmove', handle, { passive: true });
        }
    };
});

function changeImage(src, element) {
    const mainImage = $("#main-image");

    try {
        $.removeData(mainImage, 'elevateZoom');
        $('.zoomContainer').remove();

        mainImage.attr("src", src);
        mainImage.attr("data-zoom-image", src);

        setTimeout(() => {
            mainImage.elevateZoom({
                zoomType: "lens",
                lensShape: "square",
                lensSize: 200,
                zIndex: 10000,
                borderSize: 2,
                borderColour: "#3B82F6",
                scrollZoom: false,
                responsive: true,
                containLensZoom: true,
                zoomWindowPosition: 1
            });
        }, 100);

        document.querySelectorAll('.thumbnail').forEach(thumb => thumb.classList.remove('active'));
        element.classList.add('active');
    } catch (error) {
        console.error("Error in changeImage:", error);
    }
}



function selectVariant(element, type) {
    const container = element.parentElement;
    const options = container.querySelectorAll('.variant-option');
    
    options.forEach(opt => opt.classList.remove('active'));
    element.classList.add('active');
    
    const value = element.getAttribute('data-value');
    if (type === 'color') {
        document.getElementById('selected-color').textContent = value;
    } else if (type === 'type') {
        document.getElementById('selected-type').textContent = value;
    }
}

function changeTab(tabId) {
    ['details', 'specs', 'reviews'].forEach(tab => {
        const element = document.getElementById('tab-' + tab);
        if (element) element.classList.add('hidden');
    });
    
    const selectedTab = document.getElementById('tab-' + tabId);
    if (selectedTab) selectedTab.classList.remove('hidden');
    
    document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
    event.currentTarget.classList.add('active');
}
</script>

<!-- <script src="../../../js/user/cart-script.js"></script> -->